# Quest 16-B. 컨테이너

## Introduction
* 이번 퀘스트에서는 컨테이너 기술과 그 활용에 대해 알아보겠습니다.

## Topics
* 컨테이너 기술
* Docker
* docker-compose

## Resources
* [#LearnDocker](https://www.docker.com/101-tutorial)
* [Docker Tutorial for Beginners](https://docker-curriculum.com/)
* [docker-compose](https://docs.docker.com/compose/)

## Checklist
* 컨테이너는 어떻게 동작하나요? 다른 배포판을 사용할 수 있게 하는 원리가 무엇일까요?
    ```
    * 컨테이너 동작
    * 컨테이너는 격리된 환경에서 애플리케이션을 실행하는 기술입니다. 컨테이너는 운영 체제 수준 가상화 기술을 사용하여 하나의 호스트 운영 체제에서 여러 개의 컨테이너를 실행할 수 있습니다.

    * 컨테이너는 이미지를 기반으로 생성됩니다. 이미지는 애플리케이션과 해당 애플리케이션이 실행되기 위해 필요한 모든 종속성 및 구성 요소를 포함하는 패키지입니다. 이 이미지를 사용하여 컨테이너를 생성하고 실행합니다.

    * 컨테이너는 호스트 운영 체제와는 완전히 격리되어 있으며, 자체적으로 필요한 리소스를 가지고 있습니다. 이를 통해 여러 개의 컨테이너가 하나의 호스트에서 동시에 실행되어도 서로 영향을 주지 않습니다.

    * 컨테이너는 또한 빠른 배포와 확장이 가능합니다. 이미지를 기반으로 생성되기 때문에 개발 환경과 프로덕션 환경을 일관성 있게 유지할 수 있고, 필요한 경우 이미지를 업데이트하여 빠르게 배포할 수 있습니다. 또한 컨테이너 오케스트레이션 도구를 사용하여 자동으로 컨테이너를 확장하거나 축소할 수 있습니다.
    ```
    ```
    * 컨테이너가 다른 배포판을 사용할 수 있게 하는 원리
    * 컨테이너는 기본적으로 호스트 시스템과 격리된 환경에서 실행됩니다. 이것은 컨테이너가 필요한 모든 라이브러리, 바이너리, 의존성 등을 포함하고 있어 자체적으로 실행 가능하다는 것을 의미합니다.

    * 컨테이너가 다른 배포판을 사용할 수 있는 이유는 이러한 격리된 환경이 독립적으로 존재하기 때문입니다. 다른 배포판의 라이브러리와 커널 버전이 호스트 시스템과 충돌할 수 있는 경우, 컨테이너 내부에 설치된 라이브러리와 커널 버전을 사용하여 이러한 충돌을 방지할 수 있습니다.

    * 또한, 컨테이너는 이미지를 통해 배포되기 때문에 이 이미지를 다른 배포판에서도 사용할 수 있습니다. 즉, 이미지 내에 필요한 라이브러리, 의존성 등이 모두 포함되어 있기 때문에 다른 배포판에서도 동일한 이미지를 사용하여 컨테이너를 실행할 수 있습니다.
    ```

* 도커 컨테이너에 호스트의 파일시스템이나 네트워크 포트를 연결하려면 어떻게 해야 할까요?
    * 도커 컨테이너에 호스트의 파일시스템이나 네트워크 포트를 연결하기 위해서는 도커의 컨테이너 설정 옵션을 사용해야 합니다.

    * 호스트의 파일시스템을 컨테이너에 연결하기 위해서는 -v 옵션을 사용하면 됩니다. 예를 들어, 호스트의 /host/data 디렉토리를 컨테이너 내부의 /container/data 디렉토리로 연결하려면 다음과 같은 명령어를 사용합니다.
    ```
    arduino
    Copy code
    docker run -v /host/data:/container/data my-image
    ```

    * 네트워크 포트를 연결하기 위해서는 -p 옵션을 사용합니다. 예를 들어, 호스트의 8080 포트를 컨테이너 내부의 80 포트로 연결하려면 다음과 같은 명령어를 사용합니다.
    
    ```
    arduino
    Copy code
    docker run -p 8080:80 my-image
    ```

    * 이렇게 설정하면 호스트에서 http://localhost:8080 주소로 접속하면 컨테이너의 http://localhost:80 주소로 연결됩니다.

* 도커 컨테이너에서 런타임에 환경변수를 주입하려면 어떻게 해야 할까요?
    * 도커 컨테이너에서 런타임에 환경변수를 주입하는 방법은 크게 두 가지가 있습니다.

    * Dockerfile에서 ENV 명령어를 사용하는 방법
    * Dockerfile에서 ENV 명령어를 사용하여 환경변수를 정의할 수 있습니다. 예를 들어, 아래와 같이 Dockerfile을 작성할 수 있습니다.
    ```
    python
    Copy code
    FROM node:14

    ENV PORT=3000
    ENV DB_HOST=localhost
    ENV DB_PORT=5432

    ...
    ```
    * 이렇게 작성하면, 컨테이너를 실행할 때 자동으로 환경변수가 주입됩니다. 환경변수는 docker run 명령어에서 -e 옵션을 사용하여 덮어쓸 수 있습니다.

    * docker run 명령어에서 -e 옵션을 사용하는 방법
    * docker run 명령어에서 -e 옵션을 사용하여 런타임에 환경변수를 주입할 수 있습니다. 예를 들어, 아래와 같이 실행할 수 있습니다.
    ```
    arduino
    Copy code
    docker run -e "PORT=8080" -e "DB_HOST=example.com" -e "DB_PORT=5432" my-image
    ```
    * 이렇게 실행하면, 컨테이너가 실행될 때 환경변수가 주입됩니다. 이 방법을 사용하면, Dockerfile에서 환경변수를 정의하지 않아도 됩니다.


* 도커 컨테이너의 stdout 로그를 보려면 어떻게 해야 할까요?
    * 도커 컨테이너의 stdout 로그를 보는 방법은 크게 두 가지가 있습니다.

    * docker logs 명령어 사용하기
    * 도커에서 제공하는 docker logs 명령어를 사용하면 컨테이너의 stdout 로그를 볼 수 있습니다. 이 명령어는 컨테이너의 ID나 이름을 인자로 받아 사용합니다. 예를 들어, 다음과 같이 사용할 수 있습니다.
    ```
    perl
    Copy code
    docker logs my-container
    ```
    * -t 옵션과 함께 docker run 명령어 사용하기
    * 컨테이너를 실행할 때, -t 옵션과 함께 docker run 명령어를 사용하면 컨테이너의 stdout 로그를 실시간으로 볼 수 있습니다. 이 방법은 컨테이너를 실행하면서 바로 로그를 확인할 수 있기 때문에 디버깅에 유용합니다. 예를 들어, 다음과 같이 사용할 수 있습니다.
    ```
    arduino
    Copy code
    docker run -t my-image
    ```
    * 위의 명령어는 my-image 이미지를 실행하면서 컨테이너의 stdout 로그를 실시간으로 출력합니다. 로그 확인 후, ctrl + c를 눌러 컨테이너를 종료할 수 있습니다.

* 실행중인 도커 컨테이너에 들어가 bash 등의 쉘을 실행하고 로그 등을 보려면 어떻게 해야 할까요?
    * 실행 중인 도커 컨테이너에 접속하여 쉘을 실행하고 로그를 확인하는 방법은 docker exec 명령어를 사용하는 것입니다.

    * 예를 들어, 컨테이너 이름이 my-container인 도커 컨테이너에 접속하여 bash 쉘을 실행하고 로그를 확인하려면 다음과 같은 명령어를 사용할 수 있습니다.
    ```
    perl
    Copy code
    docker exec -it my-container bash
    ```
    * -it 옵션은 터미널을 사용할 수 있도록 해주며, bash는 실행할 쉘의 종류를 지정합니다. 이 명령어를 실행하면 my-container 컨테이너에 접속하여 bash 쉘을 실행할 수 있습니다. 이제 쉘에서 명령어를 입력하면 해당 컨테이너 내부에서 실행되며, 로그 등을 확인할 수 있습니다.

    * 쉘에서 빠져나오려면 exit 명령어를 입력하면 됩니다.

## Quest
* 도커를 설치하고 그 사용법을 익혀 보세요.
* 메모장 시스템 서버를 컨테이너 기반으로 띄울 수 있게 수정해 보세요. (docker-compose는 사용하지 않습니다)
* 컨테이너를 Docker Hub에 올리고, 발급받은 학습용 AWS 계정에 EC2 인스턴스를 생성한 뒤, 해당 컨테이너를 띄워서 서비스 해 보세요.
* docker-compose를 사용하여, 이미지 빌드와 서버 업/다운을 쉽게 할 수 있도록 고쳐 보세요.

## Advanced
* 도커 외의 컨테이너 기술의 대안은 어떤 것이 있을까요?
* 맥이나 윈도우에서도 컨테이너 기술을 사용할 수 있는 원리는 무엇일까요?
