# Quest 10. 인증의 이해

## Introduction
* 이번 퀘스트에서는 웹에서의 인증에 관해 알아보겠습니다.

## Topics
* Cookie
* Session
* JWT

## Resources
* [MDN - HTTP 쿠키](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies)
* [Cookies and Sessions](https://web.stanford.edu/~ouster/cgi-bin/cs142-fall10/lecture.php?topic=cookie)
* [JWT](https://jwt.io/)

## Checklist
* 쿠키란 무엇일까요?
  * 쿠키(Cookie)는 서버가 클라이언트의 웹 브라우저에 저장하는 작은 데이터 조각입니다. 쿠키는 클라이언트 측에서 생성되어, 웹 사이트를 방문할 때마다 서버로 전송됩니다. 이렇게 전송된 쿠키는 서버에서는 클라이언트를 식별하거나 클라이언트의 정보를 저장하는 등의 용도로 사용됩니다.

  쿠키는 사용자가 웹 사이트를 방문할 때, 해당 사이트에서 생성하고 브라우저에 저장됩니다. 그리고 이후에 사용자가 같은 사이트를 방문할 때마다, 브라우저는 저장된 쿠키를 서버에 전송합니다. 이를 통해, 서버는 사용자를 식별하거나 사용자의 이전 동작을 추적하는 등의 기능을 수행할 수 있습니다.

  쿠키는 일반적으로 세션 관리, 개인화, 사용자 추적 등의 용도로 사용됩니다. 예를 들어, 로그인을 할 때, 서버는 쿠키에 사용자 ID나 인증 토큰 등을 저장하고 이후에 해당 쿠키를 전송받으면 사용자를 인증하게 됩니다. 또한, 사용자의 선호 설정이나 장바구니 등의 정보도 쿠키에 저장되어 사용됩니다.

  쿠키는 클라이언트 측에서 생성되기 때문에, 브라우저 설정에서 쿠키를 차단하면 서버에서는 쿠키를 사용할 수 없게 됩니다. 또한, 쿠키는 클라이언트의 로컬에 저장되기 때문에, 다른 사용자가 해당 컴퓨터를 사용할 경우, 쿠키 정보가 노출될 수 있는 보안 문제가 있습니다. 따라서, 중요한 정보는 쿠키에 저장하지 않고, 서버 측에서 관리하거나, 보안적으로 안전한 방법으로 저장하는 것이 좋습니다.

  * 쿠키는 어떤 식으로 동작하나요?
    * 쿠키는 웹 브라우저와 서버 간의 상호 작용을 통해 동작합니다.
    1. 클라이언트에서 서버로 HTTP 요청을 보냅니다.
    2. 서버는 이 요청에 대해 응답을 보내면서 쿠키를 생성하거나, 기존의 쿠키를 수정합니다.
    3. 클라이언트는 이 응답을 받으면서, 쿠키를 웹 브라우저에 저장합니다.
    4. 이후, 클라이언트가 같은 서버로 요청을 보낼 때마다, 해당 쿠키가 요청 헤더에 함께 전송됩니다.
    5. 서버는 이 쿠키를 사용하여 클라이언트를 식별하거나, 클라이언트의 이전 동작을 추적하는 등의 기능을 수행합니다.
  * 쿠키는 어떤 식으로 서버와 클라이언트 사이에 정보를 주고받나요?
    * 쿠키는 HTTP 요청과 응답의 헤더(header)에 포함되어 서버와 클라이언트 사이에서 정보를 주고받습니다.

    서버에서 쿠키를 생성하거나 수정할 때, Set-Cookie라는 헤더를 응답에 추가하여 클라이언트에게 쿠키를 전달합니다. 이 Set-Cookie 헤더에는 쿠키의 이름, 값, 만료 날짜, 도메인 등의 정보가 포함됩니다.

    이후, 클라이언트가 같은 서버로 다시 요청을 보낼 때, 해당 요청의 헤더에 Cookie라는 헤더를 추가하여 쿠키를 전송합니다. 이 Cookie 헤더에는 클라이언트에 저장된 쿠키의 이름과 값이 포함됩니다.

    서버는 이렇게 전송된 쿠키를 사용하여 클라이언트를 식별하거나, 클라이언트의 이전 동작을 추적하는 등의 기능을 수행합니다.

    이러한 쿠키 기반의 인증 방식은 보안에 취약할 수 있으므로, 보안을 강화하기 위해 세션(ID) 토큰과 같은 방법을 사용하기도 합니다.
* 웹 어플리케이션의 세션이란 무엇일까요?
  * 웹 어플리케이션의 세션(Session)은 클라이언트와 서버 간의 상호 작용에서 특정 시간 동안 유지되는 상태 정보를 말합니다.

  웹 어플리케이션에서 세션은 주로 로그인, 인증, 권한 부여 등의 기능을 구현하기 위해 사용됩니다. 사용자가 로그인을 하면, 서버는 해당 사용자의 정보를 세션에 저장하고, 이후 요청에서 세션 ID를 확인하여 해당 사용자를 인증합니다.

  세션은 일반적으로 쿠키(Cookie)를 이용하여 구현됩니다. 클라이언트가 서버로 요청을 보낼 때, 쿠키에 세션 ID를 저장하고, 이후 요청에서 세션 ID를 서버에 전달합니다. 서버는 이 세션 ID를 이용하여 세션 정보를 가져와 클라이언트를 인증하고, 요청에 대한 처리를 수행합니다.

  세션은 보안에 중요한 역할을 합니다. 세션 정보는 서버 측에서 관리되기 때문에, 클라이언트에서는 세션 정보를 직접 변경할 수 없습니다. 또한, 세션 ID를 사용하여 인증하기 때문에, 쿠키와 마찬가지로 중요한 정보를 저장할 때는 암호화 등의 보안 기능을 사용하여 보안을 강화해야 합니다.

  * 세션의 ID와 내용은 각각 어디에 저장되고 어떻게 서버와 교환되나요?
    * 세션의 ID와 내용은 일반적으로 서버 측에서 저장되며, 서버와 클라이언트 간의 HTTP 요청과 응답을 통해 교환됩니다.

    일반적으로, 세션의 ID는 쿠키(Cookie)를 통해 클라이언트에 저장됩니다. 서버는 클라이언트에 응답할 때, Set-Cookie 헤더를 이용하여 세션 ID를 포함한 쿠키를 생성하고, 이를 클라이언트에게 전달합니다. 클라이언트는 이후 서버에 요청할 때, Cookie 헤더를 이용하여 세션 ID를 포함한 쿠키를 전송합니다.

    세션 내용은 일반적으로 서버의 메모리나 데이터베이스 등에 저장됩니다. 세션 내용을 저장하는 방식은 구현에 따라 다양하지만, 일반적으로는 세션 ID를 이용하여 서버 측에서 세션 내용을 관리합니다. 클라이언트가 요청을 보낼 때, 서버는 세션 ID를 확인하여 해당 세션의 내용을 가져온 후, 요청을 처리합니다.

    세션 ID와 내용은 보안에 중요한 역할을 합니다. 세션 ID는 클라이언트와 서버 간의 인증을 위해 사용되므로, 노출되면 안됩니다. 세션 내용은 클라이언트와 서버 간의 상태 정보를 저장하기 때문에, 중요한 정보를 포함하고 있을 수 있으므로, 암호화 등의 보안 기능을 사용하여 안전하게 저장해야 합니다.

* JWT란 무엇인가요?
  * JWT는 JSON Web Token의 약자입니다. JWT는 웹 어플리케이션에서 사용자 인증 정보를 안전하게 전달하기 위한 토큰 기반의 인증 방식 중 하나입니다.
  * JWT는 토큰의 형태로 정보를 전달하며, 이 토큰은 JSON 형태로 인코딩된 문자열입니다. JWT는 크게 세 부분으로 구성됩니다.

  * 첫 번째 부분은 토큰의 유형(타입)과 해싱 알고리즘을 지정하는 헤더(Header)입니다. 이 부분은 Base64로 인코딩됩니다.

  * 두 번째 부분은 토큰에 포함될 정보(payload)입니다. 이 부분은 클레임(Claim)이라고 불리며, 토큰에 담길 정보들을 JSON 형태로 인코딩합니다. 클레임은 등록된(Claim registered) 클레임, 공개(Public) 클레임, 개인(Private) 클레임으로 구분됩니다.

  * 세 번째 부분은 서명(Signature)입니다. 이 부분은 헤더와 페이로드를 합친 후, 비밀키(Secret key)를 이용하여 생성한 서명입니다. 서명은 JWT를 검증하는 데 사용됩니다.

  * JWT를 사용하면, 클라이언트가 서버에 로그인 요청을 보내면, 서버는 해당 사용자 정보를 확인하고, 사용자에 대한 정보를 기반으로 JWT를 생성하여 클라이언트에게 전달합니다. 클라이언트는 이후 서버에 요청을 보낼 때, JWT를 함께 전송하고, 서버는 이를 검증하여 요청을 처리합니다.
  JWT는 토큰 기반의 인증 방식 중에서도 간편하게 사용할 수 있고, 토큰 내부에 필요한 정보를 모두 담아서 전달하기 때문에, 서버에서 상태를 유지할 필요가 없어서 확장성과 유지보수성이 높습니다. 또한, 토큰 내부에 서명이 포함되어 있기 때문에, 정보의 무결성을 보장하고, 서버의 비밀키를 이용하여 검증하기 때문에, 안전성도 보장됩니다.

  * JWT 토큰은 어디에 저장되고 어떻게 서버와 교환되나요?
    * JWT 토큰은 클라이언트 측에서 보통 HTTP 요청의 헤더(header)나 쿼리 매개변수(query parameter)에 포함하여 서버에 전송됩니다.

    보통은 HTTP 요청의 Authorization 헤더에 Bearer 스키마를 사용하여 JWT 토큰을 전송합니다. 예를 들어, Authorization 헤더에 "Bearer {JWT Token}"과 같은 형식으로 전송됩니다.

    또한, JWT 토큰은 보통 브라우저 쿠키(cookie)에 저장하여 사용됩니다. 이 경우, 서버는 클라이언트가 전송한 쿠키에서 JWT 토큰을 추출하여 인증을 수행합니다.

    JWT 토큰은 서버에서 발급되기 때문에, 클라이언트는 서버로부터 JWT 토큰을 전달받아 저장해야 합니다. 일반적으로, 클라이언트는 로그인 요청에 대한 응답으로 JWT 토큰을 전달받습니다. 이후, 클라이언트는 서버에 요청을 보낼 때마다, 이 JWT 토큰을 요청에 포함하여 서버에 전송합니다. 서버는 이 JWT 토큰을 검증하여, 클라이언트가 인증된 사용자인지 확인합니다.

* 세션에 비해 JWT가 가지는 장점은 무엇인가요? 또 JWT에 비해 세션이 가지는 장점은 무엇인가요?
  * JWT의 장점은 다음과 같습니다.

  * Stateless: JWT는 서버에 상태를 저장하지 않기 때문에 stateless한 특성을 가지고 있습니다. 따라서, 서버에 부담이 줄어들고, 서버 클러스터링 등을 구현하는 데 용이합니다.

  * Cross-domain: JWT 토큰은 특정 도메인에 종속되지 않고, 다른 도메인에서도 인증을 수행할 수 있습니다.

  * Security: JWT 토큰은 서명되어 있기 때문에, 토큰 내용이 변경되지 않았는지 확인할 수 있습니다. 또한, HTTPS와 함께 사용될 경우, 토큰의 내용이 암호화되어 전송되기 때문에 보안성이 높습니다.

  * 세션의 장점은 다음과 같습니다.

  * 캐시: 세션은 서버 메모리에 저장되기 때문에, 데이터를 캐싱하여 빠른 응답을 제공할 수 있습니다.

  * 보안: 세션은 서버 측에서 처리되기 때문에, 클라이언트에서 조작할 수 없습니다.

  * 만료 시간: 세션은 서버에서 만료 시간을 설정할 수 있습니다. 이를 통해, 세션이 유효하지 않을 때 클라이언트를 강제로 로그아웃시키는 등의 보안 처리를 할 수 있습니다.

  * JWT의 단점은, 토큰의 크기가 커지면 네트워크 대역폭을 증가시킬 수 있고, 토큰이 유출될 경우 위험성이 있습니다. 따라서, 보안성을 높이기 위해서는 토큰을 안전하게 보관하는 방법을 고려해야 합니다.

  * 세션의 단점은, 세션은 서버 메모리에 저장되기 때문에, 서버 부하를 야기할 수 있습니다. 또한, 분산 환경에서 사용하기에는 어려움이 있습니다. 세션은 또한, 캐시와 같은 성능 향상 기술을 사용할 수 있지만, 이 경우에는 보안성에 제약이 따릅니다. 또한, 세션은 도메인에 종속되기 때문에, cross-domain 인증을 구현하기 어렵습니다.


## Quest
* 이번에는 메모장 시스템에 로그인 기능을 넣고자 합니다.
  * 사용자는 딱 세 명만 존재한다고 가정하고, 아이디와 비밀번호, 사용자의 닉네임은 하드코딩해도 무방합니다.
  * 로그인했을 때 해당 사용자가 이전에 작업했던 탭들과 마지막으로 활성화된 탭 등의 상태가 로딩 되어야 합니다.
  * 세션을 이용한 버전과, JWT를 이용한 버전 두 가지를 만들어 보세요!
    * 세션을 이용할 경우 세션은 서버의 메모리나 파일에 저장하면 됩니다.

## Advanced
* Web Authentication API(WebAuthn)은 무엇인가요?
