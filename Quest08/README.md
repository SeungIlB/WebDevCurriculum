# Quest 08. 웹 API의 기초

## Introduction
* 이번 퀘스트에서는 웹 API 서버의 기초를 알아보겠습니다.

## Topics
* HTTP Method
* node.js `http` module
  * `req`와 `res` 객체

## Resources
* [MDN - Content-Type Header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type)
* [MDN - HTTP Methods](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods)
* [MDN - MIME Type](https://developer.mozilla.org/en-US/docs/Glossary/MIME_type)
* [Postman](https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop)
* [HTTP Node.js Manual & Documentation](https://nodejs.org/api/http.html)

## Checklist
* HTTP의 GET과 POST 메소드는 어떻게 다른가요?
    ```
    *HTTP(GET)와 POST는 웹 브라우저와 웹 서버 간 통신에서 가장 많이 사용되는 메소드입니다. GET과 POST는 HTTP 요청을 보내고 응답을 받는 데 사용되며, 이 두 가지 메소드는 목적과 사용 방법이 서로 다릅니다.

    * GET 메소드
    GET 메소드는 서버에서 어떤 정보를 가져올 때 사용됩니다.
    브라우저의 주소 표시줄에 입력한 URL을 통해 GET 요청을 보내며, URL의 끝에 '?'를 추가하고 파라미터를 전달할 수 있습니다.
    GET 요청은 캐시되어, 동일한 요청이 여러 번 전송되어도 서버에 부담을 덜 주며, 브라우저 기록에 남습니다.
    * POST 메소드
    POST 메소드는 서버로 데이터를 보낼 때 사용됩니다.
    POST 요청은 HTTP body에 데이터를 담아 전송하며, 주로 HTML 폼(form) 데이터를 전송할 때 사용됩니다.
    POST 요청은 캐시되지 않으며, 브라우저 기록에도 남지 않습니다.
    보안 측면에서 POST 요청이 GET 요청보다 안전합니다.
    따라서, GET은 정보를 조회하는 데 사용되는 반면, POST는 데이터를 전송하는 데 사용됩니다. 또한, GET은 캐시되어 여러 번 요청되어도 서버에 부담이 적고, 브라우저 기록에 남지만, POST는 캐시되지 않으며 브라우저 기록에도 남지 않습니다.
    ```
  * 다른 HTTP 메소드에는 무엇이 있나요?
    ```
    * HTTP 프로토콜은 다양한 메소드(method)를 정의하고 있으며, 그 중에서 가장 많이 사용되는 메소드는 GET과 POST입니다. 그 외의 HTTP 메소드는 다음과 같습니다.

    * HEAD
    HEAD 메소드는 GET 메소드와 비슷하지만, 서버에서 응답으로 본문(body)을 반환하지 않습니다.
    서버에서는 요청에 대한 헤더 정보만 응답하며, 이를 이용해 자원의 메타데이터를 확인할 수 있습니다.
    * PUT
    PUT 메소드는 서버에 새로운 자원을 생성하거나, 기존 자원을 업데이트할 때 사용됩니다.
    클라이언트에서는 업데이트할 자원의 위치와 함께 데이터를 전송합니다.
    * DELETE
    DELETE 메소드는 서버에서 지정한 자원을 삭제할 때 사용됩니다.
    * OPTIONS
    OPTIONS 메소드는 서버에서 지원하는 HTTP 메소드를 확인할 때 사용됩니다.
    클라이언트가 OPTIONS 요청을 보내면, 서버는 Allow 헤더를 이용해 지원하는 메소드를 응답합니다.
    * PATCH
    PATCH 메소드는 PUT과 비슷하지만, 업데이트할 때 전체 자원을 전송하는 대신 일부만 업데이트합니다.
    일부만 업데이트할 때 사용하며, 서버에서는 변경된 부분만 업데이트합니다.
    * TRACE
    TRACE 메소드는 클라이언트에서 서버까지의 메시지 전송 경로를 확인할 때 사용됩니다.
    TRACE 요청에 대한 응답에는 클라이언트에서 보낸 요청 메시지와 함께, 경로에 따른 중간에 있는 프록시 서버들의 응답 메시지도 함께 포함됩니다.
    * 위의 HTTP 메소드는 서로 다른 목적을 가지고 있으며, RESTful API를 구현할 때 다양한 요청을 처리하는 데 사용됩니다.
    ```
* HTTP 서버에 GET과 POST를 통해 데이터를 보내려면 어떻게 해야 하나요?
  ```
  * HTTP 서버에 GET과 POST를 통해 데이터를 보내려면 클라이언트(예: 웹 브라우저)는 HTTP 요청을 작성하고 보내야 합니다. 각각의 요청은 서로 다른 방식으로 데이터를 전송합니다.

  * GET 요청으로 데이터 보내기
  GET 요청은 URL의 쿼리 문자열을 통해 데이터를 전송합니다.
  예를 들어, URL 끝에 ?key1=value1&key2=value2 와 같은 형태로 쿼리 문자열을 추가할 수 있습니다.
  서버에서는 이러한 쿼리 문자열을 파싱하여 데이터를 추출합니다.
  * POST 요청으로 데이터 보내기
  POST 요청은 HTTP 요청의 본문(body)에 데이터를 포함하여 전송합니다.
  예를 들어, HTML 폼(form) 데이터를 POST 요청으로 전송할 수 있습니다.
  폼 데이터는 name과 value 쌍으로 이루어져 있으며, 폼 요소의 name 속성 값이 key, 사용자가 입력한 값이 value에 해당합니다.
  클라이언트에서는 POST 요청 헤더에 Content-Type과 Content-Length를 포함하여 요청 본문의 타입과 길이를 명시해야 합니다.
  서버에서는 이러한 본문 데이터를 파싱하여 데이터를 추출합니다.
  즉, GET 요청은 URL 쿼리 문자열을 통해 데이터를 전송하고, POST 요청은 요청 본문에 데이터를 포함하여 전송합니다. 서버에서는 각각의 방식에 맞게 데이터를 파싱하여 추출합니다.
  ```
  * HTTP 요청의 `Content-Type` 헤더는 무엇인가요?
    * HTTP 요청의 Content-Type 헤더는 요청 본문(body)에 포함된 데이터의 타입(MIME 타입)을 명시합니다. Content-Type 헤더는 클라이언트에서 서버로 보내는 요청에서 사용됩니다.

  예를 들어, HTML 폼(form) 데이터를 POST 요청으로 서버에 전송하는 경우, Content-Type 헤더는 다음과 같이 설정될 수 있습니다.
  ```
  bash
  Copy code
  Content-Type: application/x-www-form-urlencoded
  ```
  위 예시에서 application/x-www-form-urlencoded는 HTML 폼 데이터가 URL 인코딩된 형태로 전송된다는 것을 의미합니다. 다른 예로, JSON 데이터를 전송하는 경우에는 다음과 같이 Content-Type 헤더를 설정할 수 있습니다.
  ```
  bash
  Copy code
  Content-Type: application/json
  ```
  위 예시에서 application/json은 전송되는 데이터가 JSON 형식으로 인코딩되어 있다는 것을 의미합니다. Content-Type 헤더는 서버가 요청 본문을 올바르게 해석하고 처리할 수 있도록 필수적인 정보입니다.
  * Postman에서 POST 요청을 보내는 여러 가지 방법(`form-data`, `x-www-form-urlencoded`, `raw`, `binary`) 각각은 어떤 용도를 가지고 있나요?
    ```
    * Postman에서 POST 요청을 보내는 방법은 다음과 같습니다.

    form-data: 이 방식은 폼 데이터를 전송할 때 사용됩니다. form-data는 폼 데이터를 키-값(key-value) 쌍으로 전송하며, 파일 업로드에도 사용됩니다.

    x-www-form-urlencoded: 이 방식은 form-data와 유사하지만, 폼 데이터가 URL 인코딩된 형식으로 전송됩니다. 이 방식은 폼 데이터를 전송할 때 매우 일반적으로 사용됩니다.

    raw: 이 방식은 요청 본문에 포함된 데이터를 직접 작성할 수 있습니다. 일반적으로 JSON, XML 또는 텍스트와 같은 형식의 데이터를 전송할 때 사용됩니다.

    binary: 이 방식은 파일 업로드와 같이 바이너리 데이터를 전송할 때 사용됩니다.

    요약하면, form-data는 폼 데이터 전송 및 파일 업로드에 사용됩니다. x-www-form-urlencoded는 폼 데이터를 URL 인코딩된 형식으로 전송할 때 사용됩니다. raw는 요청 본문에 직접 데이터를 작성할 때 사용됩니다. binary는 바이너리 데이터를 전송할 때 사용됩니다. 각각의 방식은 데이터 전송 방식에 따라 사용되며, 요청을 보내기 전에 어떤 방식을 사용할지 결정해야 합니다.
    ```
* node.js의 `http` 모듈을 통해 HTTP 요청을 처리할 때,
  * `req`와 `res` 객체에는 어떤 정보가 담겨있을까요?
    * http 모듈을 사용하여 HTTP 요청을 처리할 때, req와 res 객체에는 다음과 같은 정보가 담겨 있습니다.
    ```
    * req.method: HTTP 요청 메소드(GET, POST, PUT, DELETE 등)를 나타냅니다.
    * req.url: HTTP 요청 URL을 나타냅니다.
    * req.headers: HTTP 요청 헤더를 나타냅니다.
    * req.body: HTTP 요청 본문(body)에 포함된 데이터를 나타냅니다. 이 값은 data 이벤트를 사용하여 수신할 수 있습니다.
    ```
    ```
    * res.statusCode: HTTP 응답 상태 코드(200, 404, 500 등)를 나타냅니다.
    * res.statusMessage: HTTP 응답 상태 메시지(OK, Not Found, Internal Server Error 등)를 나타냅니다.
    * res.setHeader(name, value): HTTP 응답 헤더를 설정합니다.
    * res.write(data): HTTP 응답 본문에 데이터를 씁니다.
    * res.end(): HTTP 응답을 종료합니다.
    * req 객체와 res 객체를 사용하여 HTTP 요청과 응답을 처리할 수 있습니다. 이 객체들은 Node.js의 기본 모듈인 http 모듈을 비롯하여 다양한 모듈에서 사용됩니다.
    ```
  * GET과 POST에 대한 처리 형태가 달라지는 이유는 무엇인가요?
    ```
    * 데이터 전송 방식의 차이
    GET 방식은 URL에 데이터를 포함하여 전송되지만, POST 방식은 HTTP 요청 본문에 데이터를 포함하여 전송됩니다. 따라서 POST 방식은 GET 방식보다 더 많은 양의 데이터를 전송할 수 있습니다.

    요청과 응답의 구조의 차이
    HTTP 요청은 요청 헤더와 요청 본문으로 구성됩니다. GET 방식은 요청 헤더만으로 데이터를 전송하며, POST 방식은 요청 헤더와 요청 본문을 모두 사용하여 데이터를 전송합니다. 따라서 POST 방식은 요청 본문을 읽어야 하기 때문에 GET 방식보다 더 많은 자원을 사용합니다.

    보안 이슈
    GET 방식은 URL에 데이터를 노출시키기 때문에 보안에 취약합니다. 반면에 POST 방식은 요청 본문에 데이터를 포함시키기 때문에 URL에 노출되지 않습니다.

    따라서, 서버는 HTTP 요청 방식(GET 또는 POST)에 따라 요청과 응답을 처리하는 방법이 달라집니다. 예를 들어, GET 방식에서는 URL에서 데이터를 추출하여 처리하고, POST 방식에서는 요청 본문에서 데이터를 추출하여 처리합니다. 또한, POST 방식에서는 요청 본문을 읽기 위해 자원을 더 사용하기 때문에 서버의 처리 능력이 높아야 합니다.
    ```
* 만약 API 엔드포인트(URL)가 아주 많다고 한다면, HTTP POST 요청의 `Content-Type` 헤더에 따라 다른 방식으로 동작하는 서버를 어떻게 정리하면 좋을까요?
   ```
  * API 엔드포인트가 아주 많다면, HTTP POST 요청의 Content-Type 헤더에 따라 다른 방식으로 동작하는 서버를 정리하는 것은 중요합니다. 이를 위해서는 다음과 같은 방법을 고려할 수 있습니다.
  미들웨어를 사용하여 분기 처리
  미들웨어를 사용하여 HTTP 요청의 Content-Type 헤더를 확인하고, 해당하는 엔드포인트 처리 함수를 호출하도록 분기 처리할 수 있습니다. 예를 들어, Express.js에서는 body-parser 미들웨어를 사용하여 Content-Type 헤더에 따라 요청 본문을 다르게 처리할 수 있습니다.

  엔드포인트를 그룹화하여 관리
  API 엔드포인트를 그룹화하여 관리하면, HTTP 요청의 Content-Type 헤더에 따라 다른 방식으로 동작하는 서버를 더욱 쉽게 정리할 수 있습니다. 예를 들어, /api/v1/users 엔드포인트 그룹과 /api/v1/products 엔드포인트 그룹을 분리하여 처리할 수 있습니다.

  RESTful API 설계 원칙을 따르기
  RESTful API 설계 원칙을 따르면, API 엔드포인트를 자원(resource)과 행위(action)로 구분하여 관리할 수 있습니다. 이를 위해서는 자원을 URL에 표현하고, HTTP 요청 메소드를 사용하여 행위를 나타내는 방식으로 API를 설계합니다. 이러한 방식으로 설계하면, HTTP 요청의 Content-Type 헤더에 따라 다른 방식으로 동작하는 서버를 더욱 쉽게 정리할 수 있습니다.

  이러한 방법들은 API 엔드포인트가 많아지더라도 서버를 효율적으로 관리할 수 있도록 도와줍니다.
  ```
  * 그 밖에 서버가 요청들에 따라 공통적으로 처리하는 일에는 무엇이 있을까요? 이를 어떻게 정리하면 좋을까요?
  ```
    * 데이터베이스 연동 및 데이터 처리: 서버는 데이터베이스와 연동하여 데이터를 조회, 추가, 수정, 삭제 등의 작업을 수행합니다. 이를 위해 데이터베이스 쿼리를 작성하고 실행하는 등의 작업을 수행합니다.

    인증 및 보안 처리: 서버는 클라이언트의 인증 정보를 검증하고, 보안에 취약한 요청을 거부하거나 보안 처리를 수행합니다. 예를 들어, 비밀번호를 암호화하거나, HTTPS 프로토콜을 사용하여 통신을 보호합니다.

    로깅 및 모니터링: 서버는 클라이언트의 요청과 서버의 응답을 기록하여 추적 가능하도록 합니다. 또한 서버의 상태를 모니터링하여 장애 발생 여부를 파악하고 대응합니다.

    캐싱 처리: 서버는 자주 요청되는 데이터를 캐시하여 빠르게 제공할 수 있도록 합니다. 이를 통해 서버의 부하를 줄이고 성능을 향상시킵니다.

    알림 처리: 서버는 이메일, 푸시 알림 등의 방식으로 클라이언트에게 알림을 제공합니다. 예를 들어, 새로운 메시지가 도착하면 알림을 보내어 사용자에게 알려줍니다.

    이러한 서버의 공통 작업들을 정리할 때는 각 작업의 목적과 필요한 기술, 그리고 이 작업이 서비스 전체에서 어떤 위치에 위치하는지 등을 고려하여 분류하면 좋습니다. 이를 통해 서버 개발 및 유지보수를 효율적으로 수행할 수 있습니다.

  ```
## Quest
* 다음의 동작을 하는 서버를 만들어 보세요.
  * 브라우저의 주소창에 `http://localhost:8080`을 치면 `Hello World!`를 응답하여 브라우저에 출력합니다.
  * 서버의 `/foo` URL에 `bar` 변수로 임의의 문자열을 GET 메소드로 보내면, `Hello, [문자열]`을 출력합니다.
  * 서버의 `/foo` URL에 `bar` 키에 임의의 문자열 값을 갖는 JSON 객체를 POST 메소드로 보내면, `Hello, [문자열]`을 출력합니다.
  * 서버의 `/pic/upload` URL에 그림 파일을 POST 하면 서버에 보안상 적절한 방법으로 파일이 업로드 됩니다.
  * 서버의 `/pic/show` URL을 GET 하면 브라우저에 위에 업로드한 그림이 뜹니다.
  * 서버의 `/pic/download` URL을 GET 하면 브라우저에 위에 업로드한 그림이 `pic.jpg`라는 이름으로 다운로드 됩니다.
* expressJS와 같은 외부 프레임워크를 사용하지 않고, node.js의 기본 모듈만을 사용해서 만들어 보세요.
* 처리하는 요청의 종류에 따라 공통적으로 나타나는 코드를 정리해 보세요.

## Advanced
* 서버가 파일 업로드를 지원할 때 보안상 주의할 점에는 무엇이 있을까요?
