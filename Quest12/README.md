# Quest 12. 보안의 기초

## Introduction
* 이번 퀘스트에서는 가장 기초적인 웹 서비스 보안에 대해 알아보겠습니다.

## Topics
* XSS, CSRF, SQL Injection
* HTTPS, TLS

## Resources
* [The Basics of Web Application Security](https://martinfowler.com/articles/web-security-basics.html)
* [Website Security 101](https://spyrestudios.com/web-security-101/)
* [Web Security Fundamentals](https://www.shopify.com.ng/partners/blog/web-security-2018)
* [OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/)
* [Wikipedia - TLS](https://en.wikipedia.org/wiki/Transport_Layer_Security)

## Checklist
* 입력 데이터의 Validation을 웹 프론트엔드에서 했더라도 서버에서 또 해야 할까요? 그 이유는 무엇일까요?
  * 웹 프론트엔드에서 입력 데이터의 validation을 수행하더라도, 서버에서 다시 한 번 validation을 수행해야 합니다. 그 이유는 다음과 같습니다.

보안 이슈
입력 데이터의 validation은 사용자 경험을 향상시키는 중요한 요소입니다. 하지만, 클라이언트 측 validation은 사용자가 손쉽게 우회할 수 있습니다. 악의적인 사용자가 직접 HTTP 요청을 보내거나, 브라우저의 개발자 도구를 사용하여 요청을 조작할 수 있습니다. 그러므로, 서버 측에서도 입력 데이터의 validation을 수행하여 보안성을 확보해야 합니다.

일관성 유지
서버 측에서도 입력 데이터의 validation을 수행하면, 클라이언트 측과 서버 측의 validation 규칙이 일치하는지 확인할 수 있습니다. 만약, 클라이언트 측과 서버 측의 validation 규칙이 일치하지 않는다면, 데이터의 일관성을 유지하기 어렵습니다.

비즈니스 로직 적용
서버 측에서 입력 데이터의 validation을 수행하면, 비즈니스 로직과 연관된 validation을 적용할 수 있습니다. 예를 들어, 사용자의 나이에 따라 제한된 서비스를 제공하는 경우, 서버에서 나이를 확인하는 validation 규칙을 추가할 수 있습니다.

따라서, 입력 데이터의 validation은 클라이언트 측에서도 수행해야 하지만, 서버 측에서도 추가적으로 validation을 수행하여 보안성과 일관성을 유지하며 비즈니스 로직을 적용할 수 있도록 해야 합니다.

  * 서버로부터 받은 HTML 내용을 그대로 검증 없이 프론트엔드에 innerHTML 등을 통해 적용하면 어떤 문제점이 있을까요?
    * 서버로부터 받은 HTML 내용을 그대로 검증 없이 프론트엔드에 innerHTML 등을 통해 적용하면 다음과 같은 문제점이 있을 수 있습니다.

    * 보안 문제
    검증되지 않은 HTML 코드는 악성 스크립트를 포함할 수 있습니다. 이러한 악성 스크립트는 사용자의 브라우저에서 실행되어 사용자의 개인 정보를 탈취하거나, 컴퓨터 시스템을 감염시키는 등의 피해를 줄 수 있습니다.

    * 취약점 공격
    HTML 코드를 검증 없이 적용하면, 해커가 취약점을 이용하여 악성 스크립트를 삽입하는 공격에 취약해집니다. 이를 방지하기 위해서는 HTML 코드를 적용하기 전에 적절한 검증을 수행해야 합니다.

    * 웹 애플리케이션의 안정성
    HTML 코드가 검증되지 않으면, 웹 애플리케이션의 안정성이 저하됩니다. 검증되지 않은 HTML 코드는 다양한 브라우저에서 예기치 않은 동작을 일으킬 수 있으며, 이는 웹 애플리케이션의 성능을 저하시키고 사용자 경험을 저하시킬 수 있습니다.

    따라서, 서버로부터 받은 HTML 내용을 프론트엔드에 적용하기 전에 검증을 수행해야 합니다. 이를 통해 보안성과 안정성을 강화하고 웹 애플리케이션의 안전성을 유지할 수 있습니다. 검증을 위해서는 XSS(Cross-site scripting)와 같은 보안 취약점 검사 및 HTML 코드 유효성 검사와 같은 검증 방법을 사용할 수 있습니다.

  * XSS(Cross-site scripting)이란 어떤 공격기법일까요?
    * XSS(Cross-site scripting)는 웹 취약점 공격 기법 중 하나로, 악성 사용자가 웹사이트에 악성 스크립트를 삽입하여 공격하는 방법입니다. XSS 공격은 다른 사용자의 개인 정보를 탈취하거나, 쿠키를 탈취하여 세션 하이재킹 등의 공격을 수행할 수 있습니다.

    * XSS 공격은 주로 웹 어플리케이션에서 발생하며, 웹 어플리케이션에서 입력값 검증이 충분하지 않은 경우 발생할 수 있습니다. XSS 공격은 크로스 사이트 스크립팅(Cross-Site Scripting)이라고도 불리며, 다음과 같이 분류할 수 있습니다.

    * Stored XSS: 악성 스크립트가 서버에 저장되어 다른 사용자에게 제공될 때 발생하는 공격입니다. 게시판, 블로그, 메모 등에서 발생할 수 있습니다.

    * Reflected XSS: 악성 스크립트가 웹사이트에서 전달받은 인자를 통해 즉시 반환되는 경우 발생하는 공격입니다. 주로 검색 기능, 로그인 폼 등에서 발생할 수 있습니다.

    * DOM-based XSS: DOM(Document Object Model)을 조작하여 공격하는 방법입니다. 주로 JavaScript 코드를 조작하여 공격합니다.

    * XSS 공격을 방지하기 위해서는 입력값 검증을 철저하게 수행하고, 사용자의 입력값을 안전하게 처리해야 합니다. 또한, 웹 어플리케이션에서는 XSS 필터링 기능을 사용하여 악성 스크립트가 삽입되는 것을 방지할 수 있습니다.

  * CSRF(Cross-site request forgery)이란 어떤 공격기법일까요?
    * CSRF(Cross-site request forgery)는 웹 취약점 공격 기법 중 하나로, 악의적인 사용자가 인증된 사용자를 대신하여 웹 어플리케이션에 요청을 보내는 공격입니다. CSRF 공격은 인증된 사용자의 세션을 이용하여 다양한 악성 행위를 수행할 수 있습니다.

    CSRF 공격은 다음과 같은 방식으로 이루어집니다.

    * 사용자가 악성 웹사이트를 방문합니다.
    * 악성 웹사이트에서는 사용자의 브라우저를 이용하여 인증된 사용자의 웹 어플리케이션에 요청을 보내는 코드를 실행합니다.
    * 인증된 사용자의 브라우저는 악성 웹사이트에서 실행된 코드에 따라 웹 어플리케이션에 요청을 보냅니다.
    * 인증된 사용자의 세션이 유지되어 있기 때문에 웹 어플리케이션에서는 이 요청을 검증하지 않고 처리합니다.
    CSRF 공격을 방지하기 위해서는 다음과 같은 방법을 사용할 수 있습니다.

    * CSRF 토큰을 사용하여 요청을 검증합니다. 웹 어플리케이션에서는 모든 요청에 대해 고유한 CSRF 토큰을 생성하여 클라이언트에 전달합니다. 클라이언트는 이 토큰을 이용하여 요청을 보낼 때마다 검증을 수행합니다.

    * Referer 검증을 사용합니다. Referer 검증은 요청을 보낸 웹페이지의 주소를 검증하여 요청이 유효한지 판단합니다. 그러나 이 방법은 Referer 정보를 위조할 수 있는 공격기법이 있어서 보안성이 떨어집니다.

    * CORS(Cross-Origin Resource Sharing)를 이용하여 요청을 제한합니다. CORS는 웹 브라우저가 다른 도메인에서 리소스를 요청할 때, 보안상의 이유로 요청을 제한하는 기술입니다.

    이러한 방법을 통해 CSRF 공격을 방지할 수 있습니다.
  * SQL Injection이란 어떤 공격기법일까요?
    * SQL Injection은 웹 취약점 공격 기법 중 하나로, SQL 쿼리문에 악성 코드를 삽입하여 원래 의도와는 다른 동작을 유발하는 공격입니다.

    SQL Injection 공격은 다음과 같은 방식으로 이루어집니다.

    * 웹 어플리케이션에서 입력값을 받는 폼이나 URL 매개변수 등에 악성 코드를 삽입합니다.
    * 악성 코드는 SQL 쿼리문의 구문을 깨트리는 역할을 합니다. 이 때 사용되는 기술에는 주석문을 이용하는 방법, OR 연산자를 이용하여 쿼리문의 조건을 우회하는 방법, UNION 연산자를 이용하여 다른 쿼리문을 실행하는 방법 등이 있습니다.
    * SQL 쿼리문을 실행할 때, 악성 코드가 함께 실행됩니다. 이로 인해 데이터베이스 서버에서는 의도하지 않은 동작을 수행하게 됩니다. 이를 통해 데이터베이스의 정보를 조회하거나 조작할 수 있습니다.
    SQL Injection 공격을 방지하기 위해서는 다음과 같은 방법을 사용할 수 있습니다.

    * Prepared Statement를 사용합니다. Prepared Statement는 미리 컴파일된 SQL 쿼리문에 사용자 입력값을 매개변수화하여 실행하는 방법입니다. 이 방법을 사용하면 입력값이 SQL 쿼리문의 일부로 해석되는 것을 방지할 수 있습니다.

    * 입력값의 검증과 제한을 수행합니다. 입력값에 대한 유효성 검증을 수행하여 SQL 쿼리문에 삽입될 수 없도록 차단하는 방법입니다. 이를 통해 악성 코드의 삽입을 방지할 수 있습니다.

    * 데이터베이스 사용자 권한을 제한합니다. 데이터베이스 사용자 권한을 최소한으로 설정하여, 악성 코드가 삽입될 경우에도 데이터베이스 보안이 유지될 수 있도록 합니다.

    * 웹 어플리케이션 보안 업데이트를 수행합니다. 웹 어플리케이션의 취약점을 최신 보안 업데이트를 통해 보완하는 방법입니다. 이를 통해 새로운 공격 기법에 대응할 수 있습니다.

* 대부분의 최신 브라우저에서는 HTTP 대신 HTTPS가 권장됩니다. 이유가 무엇일까요?
  * HTTPS는 HTTP와 달리 데이터 암호화를 지원하는 보안 프로토콜입니다. HTTPS를 사용하면 데이터가 인터넷을 통해 전송될 때, 제 3자에 의한 가로채기나 조작을 막을 수 있습니다. 이에 따라 인터넷 사용자의 개인 정보나 중요한 데이터를 보호할 수 있으며, 웹 사이트의 신뢰성과 보안성을 높일 수 있습니다.

  * HTTPS는 HTTP에 보안 계층인 SSL(Secure Socket Layer) 또는 TLS(Transport Layer Security) 프로토콜을 추가한 것입니다. SSL 또는 TLS 프로토콜을 사용하면 클라이언트와 서버 간의 통신이 암호화되어 제 3자가 정보를 엿볼 수 없습니다. 또한 HTTPS를 사용하면 인터넷 사용자가 접속한 웹 사이트가 신뢰할 수 있는지를 확인하는 SSL 인증서를 사용할 수 있습니다. 이러한 인증서는 공인된 인증 기관에서 발급되며, 인터넷 사용자가 접속한 웹 사이트가 인증서를 소유하고 있음을 증명해줍니다. 이를 통해 사용자는 웹 사이트가 안전하다고 믿을 수 있습니다.

  * 따라서 최신 브라우저에서는 HTTPS를 권장하고 있으며, 일부 브라우저에서는 HTTPS를 사용하지 않는 웹 사이트에 대해서는 경고 메시지를 표시하거나 접속을 차단할 수도 있습니다. 이는 사용자의 개인 정보와 중요한 데이터를 보호하고, 인터넷 사용자가 안전하게 인터넷을 사용할 수 있도록 하기 위함입니다.

  * HTTPS와 TLS는 어떤 식으로 동작하나요? HTTPS는 어떤 역사를 가지고 있나요?
    * HTTPS는 HTTP 프로토콜과 SSL(Secure Socket Layer) 또는 TLS(Transport Layer Security) 프로토콜을 함께 사용하는 것입니다. SSL과 TLS는 인터넷을 통해 데이터를 전송할 때, 데이터의 암호화와 보안을 담당하는 프로토콜입니다.

    * SSL은 1995년 넷스케이프에서 처음 개발되었으며, 현재는 TLS의 이전 버전으로 여겨지고 있습니다. TLS는 SSL을 대체하기 위해 개발되었으며, 현재는 TLS 1.2와 1.3이 널리 사용되고 있습니다.

    * HTTPS는 일반적으로 웹 브라우저와 웹 서버 간의 통신에서 사용됩니다. 사용자가 HTTPS로 암호화된 웹 사이트에 접속하면, 웹 브라우저는 서버에 대한 SSL 또는 TLS 인증서를 요청하고, 서버는 인증서를 제공합니다. 웹 브라우저는 이 인증서를 사용하여 서버의 신뢰성을 확인하고, 이후 모든 통신에서 데이터를 암호화하여 보호합니다.

    * TLS 프로토콜은 인증, 암호화 및 무결성 보호를 제공합니다. 클라이언트와 서버 간의 통신에서는 일반적으로 공개키 인프라(PKI)를 사용하여 인증서를 생성하고 교환합니다. 이 인증서는 클라이언트가 서버와 안전하게 통신할 수 있음을 증명합니다.

    * TLS 프로토콜은 암호화를 위해 대칭키와 공개키 암호화 방식을 모두 사용합니다. 대칭키는 데이터를 암호화하고 복호화하는 데 사용되는 동일한 비밀키를 사용하며, 공개키는 데이터를 암호화하는 데 사용되는 공개키와 데이터를 복호화하는 데 사용되는 개인키를 사용합니다.

    * 최신 브라우저에서는 HTTPS가 권장되며, 일부 브라우저에서는 HTTPS를 사용하지 않는 웹 사이트에 대해 경고 메시지를 표시하거나 접속을 차단할 수도 있습니다. 이는 사용자의 개인 정보와 중요한 데이터를 보호하고, 인터넷 사용자가 안전하게 인터넷을 사용할 수 있도록 하기 위함입니다.

  * HTTPS의 서비스 과정에서 인증서는 어떤 역할을 할까요? 인증서는 어떤 체계로 되어 있을까요?
    * HTTPS의 서비스 과정에서 인증서는 웹 사이트의 신뢰성을 보장하기 위한 역할을 합니다. 인증서는 웹 사이트가 정식인지 확인하고, 암호화 통신을 위한 공개키를 제공합니다.

    인증서는 인증 기관(Certificate Authority, CA)이 발급합니다. 인증 기관은 클라이언트가 서버의 신뢰성을 확인할 수 있도록 서버 인증서를 발급하는 중개 역할을 합니다.

    웹 사이트 운영자는 인증 기관에 자신의 도메인 정보와 공개키를 제출하고, 인증 기관은 도메인의 신뢰성을 확인한 후 인증서를 발급합니다. 이후에는 웹 사이트에서 발급받은 인증서를 웹 브라우저에 전송하여 클라이언트와 서버 간의 안전한 통신을 가능하게 합니다.

    인증서는 공개키 기반 인프라(PKI) 체계를 사용하여 만들어집니다. PKI는 대칭키 암호화 방식과 공개키 암호화 방식을 사용하여 데이터를 암호화하고 복호화합니다. 인증서는 웹 사이트 운영자의 공개키와 서명된 인증 기관의 개인키를 사용하여 생성됩니다.

    인증서는 일반적으로 X.509 인증서 형식을 따릅니다. 이 형식은 인증서의 정보를 정의하기 위한 표준 형식으로, 인증서에는 다음과 같은 정보가 포함됩니다.

      * 발급 기관 정보: 인증서를 발급한 인증 기관의 이름과 공개키가 포함됩니다.
      * 서버 정보: 웹 사이트의 도메인 이름, 서버의 공개키 등이 포함됩니다.
      * 인증서의 유효 기간: 인증서가 유효한 기간이 명시됩니다.
      * 서명: 인증 기관의 개인키를 사용하여 서명된 인증서의 디지털 서명이 포함됩니다.
    인증서는 HTTPS 통신에서 중요한 역할을 담당하고 있으며, 인증서의 발급과 관리는 웹 사이트 보안을 유지하는 데 매우 중요합니다.

## Quest
* 메모장의 서버와 클라이언트에 대해, 로컬에서 발행한 인증서를 통해 HTTPS 서비스를 해 보세요.

## Advanced
* TLS의 인증서에 쓰이는 암호화 알고리즘은 어떤 종류가 있을까요?
* HTTP/3은 기존 버전과 어떻게 다를까요? HTTP의 버전 3이 나오게 된 이유는 무엇일까요?
